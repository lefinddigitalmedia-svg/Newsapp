<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Image Cropper - Crop, Edit & Enhance Images</title>
    <meta name="description" content="Free online tool to crop, edit and enhance images. Supports multiple aspect ratios, creative shapes, filters, and social media presets.">
    <meta name="keywords" content="image cropper, crop tool, photo editor, aspect ratio, social media crop">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        :root {
            --primary: #6e8efb;
            --primary-dark: #5a7dfa;
            --secondary: #a777e3;
            --accent: #ff7e5f;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --transition: all 0.3s ease;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            transform: rotate(30deg);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo h1 {
            font-size: 28px;
            font-weight: 700;
            margin-right: 15px;
            background: linear-gradient(to right, #fff, #e6e6e6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .header-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            text-decoration: none;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .back-btn i {
            margin-right: 8px;
        }
        
        .info-icon {
            background: none;
            border: none;
            color: white;
            font-size: 22px;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
        }
        
        .info-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(15deg);
        }
        
        /* Ad Banner */
        .ad-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .ad-banner {
            width: 728px;
            height: 90px;
            background: #f8f9ff;
            border: 2px dashed var(--primary);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--gray);
            font-size: 14px;
            transition: var(--transition);
            overflow: hidden;
        }
        
        .ad-banner:hover {
            background: #eef1ff;
            transform: translateY(-3px);
        }
        
        .ad-banner iframe {
            border: none;
        }
        
        /* Main Content */
        .main-content {
            display: flex;
            margin: 40px 0;
            gap: 30px;
        }
        
        /* Left Panel - Controls */
        .controls-panel {
            flex: 1;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .controls-panel:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-5px);
        }
        
        .panel-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .panel-section:last-child {
            border-bottom: none;
        }
        
        .panel-section h2 {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--dark);
            display: flex;
            align-items: center;
            font-weight: 600;
        }
        
        .panel-section h2 i {
            margin-right: 12px;
            color: var(--primary);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .upload-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .upload-btn {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9ff;
            border: 2px dashed var(--primary);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .upload-btn:hover {
            background: #eef1ff;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(110, 142, 251, 0.2);
        }
        
        .upload-btn i {
            margin-right: 12px;
            color: var(--primary);
            font-size: 20px;
            transition: var(--transition);
        }
        
        .upload-btn:hover i {
            transform: scale(1.2);
        }
        
        .upload-btn input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        
        /* Aspect Ratio Selection */
        .aspect-ratios {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .aspect-ratio-btn {
            padding: 12px 8px;
            background: #f8f9ff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            font-size: 14px;
            font-weight: 500;
        }
        
        .aspect-ratio-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
        }
        
        .aspect-ratio-btn:hover:not(.active) {
            background: #eef1ff;
            transform: translateY(-2px);
        }
        
        /* Toolbar */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tool-btn {
            padding: 10px 15px;
            background: #f8f9ff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: var(--transition);
            font-size: 14px;
            font-weight: 500;
        }
        
        .tool-btn i {
            margin-right: 8px;
            color: var(--primary);
            transition: var(--transition);
        }
        
        .tool-btn:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
            transform: translateY(-2px);
        }
        
        .tool-btn:hover i {
            color: white;
            transform: rotate(-10deg);
        }
        
        .tool-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
        }
        
        /* Slider Controls */
        .slider-control {
            margin: 15px 0;
        }
        
        .slider-control label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--gray);
            font-weight: 500;
        }
        
        .slider-control .slider-value {
            float: right;
            font-weight: 600;
            color: var(--primary);
        }
        
        .slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: #e2e8f0;
            outline: none;
            border-radius: 3px;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(110, 142, 251, 0.5);
            transition: var(--transition);
        }
        
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        
        /* Social Media Presets */
        .social-presets {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .social-preset {
            padding: 12px 8px;
            background: #f8f9ff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            font-size: 14px;
            font-weight: 500;
        }
        
        .social-preset:hover {
            background: #eef1ff;
            transform: translateY(-2px);
        }
        
        .social-preset i {
            margin-right: 8px;
            color: var(--primary);
        }
        
        /* Right Panel - Preview */
        .preview-panel {
            flex: 2;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
        }
        
        .preview-panel:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-5px);
        }
        
        .preview-container {
            position: relative;
            flex: 1;
            border: 2px dashed #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 25px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #fafbff;
            transition: var(--transition);
            min-height: 400px;
        }
        
        .preview-container.drag-over {
            border-color: var(--primary);
            background: rgba(110, 142, 251, 0.05);
        }
        
        .preview-container .placeholder {
            color: var(--gray);
            text-align: center;
            padding: 20px;
        }
        
        .preview-container .placeholder i {
            font-size: 56px;
            margin-bottom: 20px;
            display: block;
            color: #e2e8f0;
            transition: var(--transition);
        }
        
        .preview-container:hover .placeholder i {
            color: var(--primary);
            transform: scale(1.1);
        }
        
        .canvas-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: none;
        }
        
        #cropCanvas {
            max-width: 100%;
            max-height: 100%;
            display: block;
            margin: 0 auto;
        }
        
        .crop-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .crop-area {
            position: absolute;
            border: 2px dashed #fff;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
            cursor: move;
        }
        
        .crop-handle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 50%;
            pointer-events: all;
        }
        
        .handle-nw { top: -6px; left: -6px; cursor: nw-resize; }
        .handle-ne { top: -6px; right: -6px; cursor: ne-resize; }
        .handle-sw { bottom: -6px; left: -6px; cursor: sw-resize; }
        .handle-se { bottom: -6px; right: -6px; cursor: se-resize; }
        
        .preview-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .preview-btn {
            padding: 12px 20px;
            background: #f8f9ff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .preview-btn i {
            margin-right: 8px;
            color: var(--primary);
            transition: var(--transition);
        }
        
        .preview-btn:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 142, 251, 0.3);
        }
        
        .preview-btn:hover i {
            color: white;
            transform: rotate(-10deg);
        }
        
        .preview-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .preview-btn:disabled:hover {
            background: #f8f9ff;
            color: inherit;
            border: 1px solid #e2e8f0;
            transform: none;
            box-shadow: none;
        }
        
        .preview-btn:disabled:hover i {
            color: var(--primary);
            transform: none;
        }
        
        .file-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            background: #fafbff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }
        
        .info-box h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .info-box h3 i {
            margin-right: 10px;
            color: var(--primary);
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .info-item .label {
            color: var(--gray);
        }
        
        .info-item .value {
            font-weight: 500;
            color: var(--dark);
        }
        
        /* Footer */
        footer {
            background: white;
            padding: 40px 0;
            border-top: 1px solid #e2e8f0;
            margin-top: 60px;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .footer-note {
            text-align: center;
            max-width: 600px;
            margin-bottom: 25px;
            color: var(--gray);
            font-size: 15px;
        }
        
        .footer-links {
            display: flex;
            gap: 25px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .footer-links a {
            color: var(--primary);
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
        }
        
        .footer-links a i {
            margin-right: 8px;
        }
        
        .footer-links a:hover {
            color: var(--secondary);
            transform: translateY(-2px);
        }
        
        .pro-tip {
            background: #f8f9ff;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 15px;
            color: var(--dark);
            border-left: 4px solid var(--primary);
            max-width: 600px;
            text-align: center;
        }
        
        /* FAQ Section */
        .faq-section {
            background: white;
            padding: 50px;
            border-radius: 16px;
            margin: 50px 0;
            box-shadow: var(--shadow);
        }
        
        .faq-section h2 {
            text-align: center;
            margin-bottom: 40px;
            color: var(--dark);
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .faq-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .faq-item {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 0;
            transition: var(--transition);
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }
        
        .faq-item.active {
            box-shadow: var(--shadow);
        }
        
        .faq-question {
            font-size: 18px;
            font-weight: 600;
            padding: 20px 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .faq-question:hover {
            background: rgba(110, 142, 251, 0.05);
        }
        
        .faq-question i {
            color: var(--primary);
            font-size: 20px;
            transition: var(--transition);
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .faq-answer {
            color: var(--gray);
            line-height: 1.7;
            font-size: 15px;
            padding: 0 25px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }
        
        .faq-item.active .faq-answer {
            padding: 0 25px 25px 25px;
            max-height: 500px;
        }
        
        .faq-answer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }
        
        .faq-answer a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }
        
        /* Contact Section */
        .contact-section {
            background: white;
            padding: 50px;
            border-radius: 16px;
            margin: 50px 0;
            box-shadow: var(--shadow);
        }
        
        .contact-section h2 {
            text-align: center;
            margin-bottom: 40px;
            color: var(--dark);
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .contact-card {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            transition: var(--transition);
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .contact-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }
        
        .contact-card:hover .contact-icon {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .contact-card:hover .contact-detail {
            color: white;
        }
        
        .contact-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 30px;
            color: var(--primary);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }
        
        .contact-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .contact-detail {
            color: var(--gray);
            transition: var(--transition);
        }
        
        /* Responsive Design */
        @media (max-width: 1100px) {
            .main-content {
                flex-direction: column;
            }
            
            .controls-panel {
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .faq-section, .contact-section {
                padding: 30px;
            }
            
            .faq-grid, .contact-grid {
                grid-template-columns: 1fr;
            }
            
            .ad-banner {
                width: 468px;
                height: 60px;
            }
        }
        
        @media (max-width: 600px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .logo {
                flex-direction: column;
            }
            
            .logo h1 {
                margin-right: 0;
                margin-bottom: 5px;
            }
            
            .file-info {
                grid-template-columns: 1fr;
            }
            
            .preview-controls {
                flex-direction: column;
            }
            
            .aspect-ratios {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .social-presets {
                grid-template-columns: 1fr;
            }
            
            .ad-banner {
                width: 300px;
                height: 250px;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s ease;
            position: relative;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .modal-header h2 {
            color: var(--dark);
            font-size: 24px;
            font-weight: 700;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
        }
        
        .close-btn:hover {
            color: var(--danger);
            transform: rotate(90deg);
        }
        
        /* Loading spinner */
        .spinner {
            display: none;
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }
        
        .toast.error {
            background: var(--danger);
        }
        
        /* Grid Overlay */
        .grid-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: none;
        }
        
        .grid-line {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
        }
        
        .grid-vertical {
            width: 1px;
            height: 100%;
        }
        
        .grid-horizontal {
            width: 100%;
            height: 1px;
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1>Advanced Image Cropper</h1>
                    <p>Crop, edit and enhance your images with precision</p>
                </div>
                <div class="header-buttons">
                    <a href="tools.html" class="back-btn">
                        <i class="fas fa-arrow-left"></i> Back to Tools
                    </a>
                    <button class="info-icon" id="infoBtn">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Ad Banner -->
    <div class="container">
        <div class="ad-container">
            <div class="ad-banner">
                <script type="text/javascript">
                    atOptions = {
                        'key' : '47a3b7092d0681b8c30c2d1ba1bded19',
                        'format' : 'iframe',
                        'height' : 90,
                        'width' : 728,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/47a3b7092d0681b8c30c2d1ba1bded19/invoke.js"></script>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <!-- Left Panel - Controls -->
            <div class="controls-panel">
                <div class="panel-section">
                    <h2><i class="fas fa-upload"></i> Upload Image</h2>
                    <div class="upload-options">
                        <div class="upload-btn">
                            <i class="fas fa-file-upload"></i> Upload from Device
                            <input type="file" id="fileUpload" accept="image/*">
                        </div>
                    </div>
                </div>
                
                <div class="panel-section">
                    <h2><i class="fas fa-crop-alt"></i> Crop Settings</h2>
                    
                    <div class="aspect-ratios">
                        <div class="aspect-ratio-btn active" data-ratio="free">Free</div>
                        <div class="aspect-ratio-btn" data-ratio="1:1">1:1</div>
                        <div class="aspect-ratio-btn" data-ratio="16:9">16:9</div>
                        <div class="aspect-ratio-btn" data-ratio="9:16">9:16</div>
                        <div class="aspect-ratio-btn" data-ratio="4:3">4:3</div>
                        <div class="aspect-ratio-btn" data-ratio="3:2">3:2</div>
                        <div class="aspect-ratio-btn" data-ratio="custom">Custom</div>
                    </div>
                    
                    <div class="custom-ratio" id="customRatio" style="display: none;">
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <input type="number" id="customWidth" placeholder="Width" min="1" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <span style="line-height: 40px;">×</span>
                            <input type="number" id="customHeight" placeholder="Height" min="1" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                    </div>
                    
                    <div class="toolbar">
                        <div class="tool-btn" id="rotateLeftBtn">
                            <i class="fas fa-undo"></i> Rotate Left
                        </div>
                        <div class="tool-btn" id="rotateRightBtn">
                            <i class="fas fa-redo"></i> Rotate Right
                        </div>
                        <div class="tool-btn" id="flipHBtn">
                            <i class="fas fa-arrows-alt-h"></i> Flip H
                        </div>
                        <div class="tool-btn" id="flipVBtn">
                            <i class="fas fa-arrows-alt-v"></i> Flip V
                        </div>
                        <div class="tool-btn" id="fitToAreaBtn">
                            <i class="fas fa-expand"></i> Fit to Area
                        </div>
                        <div class="tool-btn" id="resetBtn">
                            <i class="fas fa-sync"></i> Reset
                        </div>
                    </div>
                </div>
                
                <div class="panel-section">
                    <h2><i class="fas fa-magic"></i> Enhancements</h2>
                    
                    <div class="toolbar">
                        <div class="tool-btn" id="autoEnhanceBtn">
                            <i class="fas fa-wand-magic-sparkles"></i> Auto Enhance
                        </div>
                        <div class="tool-btn" id="blurBgBtn">
                            <i class="fas fa-droplet"></i> Blur Background
                        </div>
                    </div>
                    
                    <div class="slider-control">
                        <label>Brightness <span class="slider-value" id="brightnessValue">0</span></label>
                        <input type="range" id="brightness" class="slider" min="-100" max="100" value="0">
                    </div>
                    
                    <div class="slider-control">
                        <label>Contrast <span class="slider-value" id="contrastValue">0</span></label>
                        <input type="range" id="contrast" class="slider" min="-100" max="100" value="0">
                    </div>
                    
                    <div class="slider-control">
                        <label>Saturation <span class="slider-value" id="saturationValue">0</span></label>
                        <input type="range" id="saturation" class="slider" min="-100" max="100" value="0">
                    </div>
                    
                    <div class="slider-control">
                        <label>Blur Intensity <span class="slider-value" id="blurValue">0</span></label>
                        <input type="range" id="blur" class="slider" min="0" max="20" value="0">
                    </div>
                </div>
                
                <div class="panel-section">
                    <h2><i class="fas fa-shapes"></i> Creative Options</h2>
                    
                    <div class="toolbar">
                        <div class="tool-btn" id="roundedCornersBtn">
                            <i class="fas fa-circle"></i> Rounded Corners
                        </div>
                        <div class="tool-btn" id="circleCropBtn">
                            <i class="fas fa-circle-notch"></i> Circle Crop
                        </div>
                    </div>
                    
                    <div class="slider-control" id="cornerRadiusControl">
                        <label>Corner Radius <span class="slider-value" id="cornerRadiusValue">0</span></label>
                        <input type="range" id="cornerRadius" class="slider" min="0" max="100" value="0">
                    </div>
                    
                    <div class="toolbar">
                        <div class="tool-btn" id="addBorderBtn">
                            <i class="fas fa-square-full"></i> Add Border
                        </div>
                        <div class="tool-btn" id="addShadowBtn">
                            <i class="fas fa-cloud"></i> Add Shadow
                        </div>
                    </div>
                </div>
                
                <div class="panel-section">
                    <h2><i class="fas fa-share-alt"></i> Social Media Presets</h2>
                    
                    <div class="social-presets">
                        <div class="social-preset" data-preset="instagram-post">
                            <i class="fab fa-instagram"></i> Instagram Post
                        </div>
                        <div class="social-preset" data-preset="instagram-story">
                            <i class="fab fa-instagram"></i> Instagram Story
                        </div>
                        <div class="social-preset" data-preset="facebook-cover">
                            <i class="fab fa-facebook"></i> Facebook Cover
                        </div>
                        <div class="social-preset" data-preset="twitter-post">
                            <i class="fab fa-twitter"></i> Twitter Post
                        </div>
                        <div class="social-preset" data-preset="youtube-thumbnail">
                            <i class="fab fa-youtube"></i> YouTube Thumbnail
                        </div>
                        <div class="social-preset" data-preset="linkedin-banner">
                            <i class="fab fa-linkedin"></i> LinkedIn Banner
                        </div>
                    </div>
                </div>
                
                <div class="panel-section">
                    <h2><i class="fas fa-eye"></i> View Options</h2>
                    
                    <div class="toolbar">
                        <div class="tool-btn" id="gridBtn">
                            <i class="fas fa-th"></i> Show Grid
                        </div>
                        <div class="tool-btn" id="zoomInBtn">
                            <i class="fas fa-search-plus"></i> Zoom In
                        </div>
                        <div class="tool-btn" id="zoomOutBtn">
                            <i class="fas fa-search-minus"></i> Zoom Out
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Panel - Preview -->
            <div class="preview-panel">
                <div class="preview-container" id="previewContainer">
                    <div class="placeholder" id="previewPlaceholder">
                        <i class="fas fa-crop-alt"></i>
                        <p>Upload an image to start cropping</p>
                        <p class="file-size">or drag and drop an image here</p>
                    </div>
                    <div class="canvas-container" id="canvasContainer">
                        <canvas id="cropCanvas"></canvas>
                        <div class="crop-overlay" id="cropOverlay">
                            <div class="crop-area" id="cropArea">
                                <div class="crop-handle handle-nw"></div>
                                <div class="crop-handle handle-ne"></div>
                                <div class="crop-handle handle-sw"></div>
                                <div class="crop-handle handle-se"></div>
                            </div>
                        </div>
                        <div class="grid-overlay" id="gridOverlay">
                            <!-- Grid lines will be added dynamically -->
                        </div>
                    </div>
                </div>
                
                <div class="spinner" id="spinner"></div>
                
                <div class="preview-controls">
                    <div class="preview-btn" id="cropBtn" disabled>
                        <i class="fas fa-crop-alt"></i> Apply Crop
                    </div>
                    <div class="preview-btn" id="downloadBtn" disabled>
                        <i class="fas fa-download"></i> Download
                    </div>
                    <div class="preview-btn" id="batchCropBtn" disabled>
                        <i class="fas fa-layer-group"></i> Batch Crop
                    </div>
                    <div class="preview-btn" id="savePresetBtn">
                        <i class="fas fa-save"></i> Save Preset
                    </div>
                </div>
                
                <div class="file-info">
                    <div class="info-box">
                        <h3><i class="fas fa-info-circle"></i> Original Image</h3>
                        <div class="info-item">
                            <span class="label">Dimensions:</span>
                            <span class="value" id="originalDimensions">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Size:</span>
                            <span class="value" id="originalSize">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Format:</span>
                            <span class="value" id="originalFormat">-</span>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <h3><i class="fas fa-crop-alt"></i> Crop Area</h3>
                        <div class="info-item">
                            <span class="label">Dimensions:</span>
                            <span class="value" id="cropDimensions">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Aspect Ratio:</span>
                            <span class="value" id="cropAspectRatio">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Position:</span>
                            <span class="value" id="cropPosition">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- FAQ Section -->
        <div class="faq-section">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <div class="faq-question">
                        <span>How do I use this image cropping tool?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Using our cropping tool is simple:</p>
                        <ol>
                            <li>Upload an image from your device</li>
                            <li>Select an aspect ratio or use free cropping</li>
                            <li>Adjust the crop area by dragging the handles</li>
                            <li>Apply enhancements like brightness, contrast, or blur</li>
                            <li>Use creative options like rounded corners or circle crops</li>
                            <li>Download your cropped image in the desired format</li>
                        </ol>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>What image formats are supported?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Our tool supports all major image formats:</p>
                        <ul>
                            <li><strong>JPG/JPEG</strong> - Best for photographs</li>
                            <li><strong>PNG</strong> - Supports transparency</li>
                            <li><strong>WEBP</strong> - Modern format with excellent compression</li>
                            <li><strong>SVG</strong> - Vector format (for upload only)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Can I crop multiple images at once?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes! Our tool supports batch cropping of multiple images:</p>
                        <ol>
                            <li>Enable the "Batch Crop" option</li>
                            <li>Select multiple files when uploading</li>
                            <li>Set your desired crop settings</li>
                            <li>All images will be cropped with the same settings</li>
                            <li>Download all cropped images as a ZIP file</li>
                        </ol>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>What are the social media preset sizes?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Our social media presets use the following dimensions:</p>
                        <ul>
                            <li><strong>Instagram Post</strong> - 1080×1080 pixels (1:1)</li>
                            <li><strong>Instagram Story</strong> - 1080×1920 pixels (9:16)</li>
                            <li><strong>Facebook Cover</strong> - 820×312 pixels</li>
                            <li><strong>Twitter Post</strong> - 1600×900 pixels (16:9)</li>
                            <li><strong>YouTube Thumbnail</strong> - 1280×720 pixels (16:9)</li>
                            <li><strong>LinkedIn Banner</strong> - 1584×396 pixels</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact Section -->
        <div class="contact-section">
            <h2>Get in Touch With Us</h2>
            <div class="contact-grid">
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="contact-title">Support</div>
                    <div class="contact-detail">support@clickdera.in</div>
                </div>
                
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div class="contact-title">Suggestions</div>
                    <div class="contact-detail">suggestion@clickdera.in</div>
                </div>
                
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="contact-title">YouTube Channel</div>
                    <div class="contact-detail">ClickDera Tutorials</div>
                </div>
            </div>
        </div>
        
        <!-- Ad Banner -->
        <div class="ad-container">
            <div class="ad-banner">
                <script type="text/javascript">
                    atOptions = {
                        'key' : '47a3b7092d0681b8c30c2d1ba1bded19',
                        'format' : 'iframe',
                        'height' : 60,
                        'width' : 468,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/47a3b7092d0681b8c30c2d1ba1bded19/invoke.js"></script>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <p class="footer-note">All image cropping happens in your browser. Files are never uploaded to any server.</p>
                
                <div class="footer-links">
                    <a href="#"><i class="fas fa-shield-alt"></i> Privacy Policy</a>
                    <a href="#"><i class="fas fa-info-circle"></i> About</a>
                    <a href="#"><i class="fas fa-envelope"></i> Contact</a>
                    <a href="mailto:support@clickdera.in"><i class="fas fa-headset"></i> Support</a>
                    <a href="https://youtube.com/@clickdera?si=BfO2KVHeJY6KP4vA" target="_blank"><i class="fab fa-youtube"></i> YouTube</a>
                </div>
                
                <div class="pro-tip">
                    <strong>Pro Tip:</strong> Use the social media presets to quickly crop images for different platforms!
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Info Modal -->
    <div class="modal" id="infoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>How to Use This Tool</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Follow these simple steps to crop and enhance your images:</p>
                <ol>
                    <li>Upload an image from your device</li>
                    <li>Select an aspect ratio or use free cropping</li>
                    <li>Adjust the crop area by dragging the handles</li>
                    <li>Use the enhancement tools to improve your image</li>
                    <li>Apply creative options like rounded corners or borders</li>
                    <li>Download your final image in the desired format</li>
                </ol>
                <p>All processing happens locally in your browser - your images are never uploaded to any server, ensuring complete privacy.</p>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>
    
    <script>
        // Global variables
        let originalImage = null;
        let currentImage = null;
        let canvas = null;
        let ctx = null;
        let cropArea = null;
        let isDragging = false;
        let dragHandle = null;
        let startX, startY;
        let cropX = 100, cropY = 100, cropWidth = 300, cropHeight = 300;
        let aspectRatio = 'free';
        let zoomLevel = 1;
        let imageOffsetX = 0, imageOffsetY = 0;
        let isGridVisible = false;
        
        // Enhancement values
        let brightness = 0;
        let contrast = 0;
        let saturation = 0;
        let blur = 0;
        let cornerRadius = 0;
        
        // DOM Elements
        const fileUpload = document.getElementById('fileUpload');
        const previewContainer = document.getElementById('previewContainer');
        const previewPlaceholder = document.getElementById('previewPlaceholder');
        const canvasContainer = document.getElementById('canvasContainer');
        const cropCanvas = document.getElementById('cropCanvas');
        const cropOverlay = document.getElementById('cropOverlay');
        const cropAreaElem = document.getElementById('cropArea');
        const gridOverlay = document.getElementById('gridOverlay');
        const aspectRatioBtns = document.querySelectorAll('.aspect-ratio-btn');
        const customRatio = document.getElementById('customRatio');
        const customWidth = document.getElementById('customWidth');
        const customHeight = document.getElementById('customHeight');
        const rotateLeftBtn = document.getElementById('rotateLeftBtn');
        const rotateRightBtn = document.getElementById('rotateRightBtn');
        const flipHBtn = document.getElementById('flipHBtn');
        const flipVBtn = document.getElementById('flipVBtn');
        const fitToAreaBtn = document.getElementById('fitToAreaBtn');
        const resetBtn = document.getElementById('resetBtn');
        const autoEnhanceBtn = document.getElementById('autoEnhanceBtn');
        const blurBgBtn = document.getElementById('blurBgBtn');
        const roundedCornersBtn = document.getElementById('roundedCornersBtn');
        const circleCropBtn = document.getElementById('circleCropBtn');
        const addBorderBtn = document.getElementById('addBorderBtn');
        const addShadowBtn = document.getElementById('addShadowBtn');
        const gridBtn = document.getElementById('gridBtn');
        const zoomInBtn = document.getElementById('zoomInBtn');
        const zoomOutBtn = document.getElementById('zoomOutBtn');
        const cropBtn = document.getElementById('cropBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const batchCropBtn = document.getElementById('batchCropBtn');
        const savePresetBtn = document.getElementById('savePresetBtn');
        const socialPresets = document.querySelectorAll('.social-preset');
        const brightnessSlider = document.getElementById('brightness');
        const contrastSlider = document.getElementById('contrast');
        const saturationSlider = document.getElementById('saturation');
        const blurSlider = document.getElementById('blur');
        const cornerRadiusSlider = document.getElementById('cornerRadius');
        const brightnessValue = document.getElementById('brightnessValue');
        const contrastValue = document.getElementById('contrastValue');
        const saturationValue = document.getElementById('saturationValue');
        const blurValue = document.getElementById('blurValue');
        const cornerRadiusValue = document.getElementById('cornerRadiusValue');
        const originalDimensions = document.getElementById('originalDimensions');
        const originalSize = document.getElementById('originalSize');
        const originalFormat = document.getElementById('originalFormat');
        const cropDimensions = document.getElementById('cropDimensions');
        const cropAspectRatio = document.getElementById('cropAspectRatio');
        const cropPosition = document.getElementById('cropPosition');
        const spinner = document.getElementById('spinner');
        const toast = document.getElementById('toast');
        const faqItems = document.querySelectorAll('.faq-item');
        
        // Initialize the application
        function init() {
            canvas = cropCanvas;
            ctx = canvas.getContext('2d');
            cropArea = cropAreaElem;
            
            setupEventListeners();
            setupDragAndDrop();
            setupFAQAccordion();
            updateCropInfo();
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            // Info modal functionality
            document.getElementById('infoBtn').addEventListener('click', () => {
                document.getElementById('infoModal').style.display = 'flex';
            });
            
            document.getElementById('closeModal').addEventListener('click', () => {
                document.getElementById('infoModal').style.display = 'none';
            });
            
            window.addEventListener('click', (e) => {
                if (e.target === document.getElementById('infoModal')) {
                    document.getElementById('infoModal').style.display = 'none';
                }
            });
            
            // File upload functionality
            fileUpload.addEventListener('change', handleFileUpload);
            
            // Aspect ratio selection
            aspectRatioBtns.forEach(button => {
                button.addEventListener('click', () => {
                    aspectRatioBtns.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    aspectRatio = button.getAttribute('data-ratio');
                    
                    if (aspectRatio === 'custom') {
                        customRatio.style.display = 'block';
                    } else {
                        customRatio.style.display = 'none';
                        applyAspectRatio();
                    }
                    
                    updateCropInfo();
                });
            });
            
            // Custom ratio inputs
            customWidth.addEventListener('input', applyCustomRatio);
            customHeight.addEventListener('input', applyCustomRatio);
            
            // Tool buttons
            rotateLeftBtn.addEventListener('click', () => rotateImage(-90));
            rotateRightBtn.addEventListener('click', () => rotateImage(90));
            flipHBtn.addEventListener('click', flipHorizontal);
            flipVBtn.addEventListener('click', flipVertical);
            fitToAreaBtn.addEventListener('click', fitToArea);
            resetBtn.addEventListener('click', resetImage);
            autoEnhanceBtn.addEventListener('click', autoEnhance);
            blurBgBtn.addEventListener('click', toggleBlurBackground);
            roundedCornersBtn.addEventListener('click', toggleRoundedCorners);
            circleCropBtn.addEventListener('click', applyCircleCrop);
            addBorderBtn.addEventListener('click', toggleBorder);
            addShadowBtn.addEventListener('click', toggleShadow);
            gridBtn.addEventListener('click', toggleGrid);
            zoomInBtn.addEventListener('click', () => zoomImage(0.1));
            zoomOutBtn.addEventListener('click', () => zoomImage(-0.1));
            cropBtn.addEventListener('click', applyCrop);
            downloadBtn.addEventListener('click', downloadImage);
            batchCropBtn.addEventListener('click', batchCrop);
            savePresetBtn.addEventListener('click', savePreset);
            
            // Social media presets
            socialPresets.forEach(preset => {
                preset.addEventListener('click', () => {
                    const presetType = preset.getAttribute('data-preset');
                    applySocialPreset(presetType);
                });
            });
            
            // Enhancement sliders
            brightnessSlider.addEventListener('input', () => {
                brightness = parseInt(brightnessSlider.value);
                brightnessValue.textContent = brightness;
                applyEnhancements();
            });
            
            contrastSlider.addEventListener('input', () => {
                contrast = parseInt(contrastSlider.value);
                contrastValue.textContent = contrast;
                applyEnhancements();
            });
            
            saturationSlider.addEventListener('input', () => {
                saturation = parseInt(saturationSlider.value);
                saturationValue.textContent = saturation;
                applyEnhancements();
            });
            
            blurSlider.addEventListener('input', () => {
                blur = parseInt(blurSlider.value);
                blurValue.textContent = blur;
                applyEnhancements();
            });
            
            cornerRadiusSlider.addEventListener('input', () => {
                cornerRadius = parseInt(cornerRadiusSlider.value);
                cornerRadiusValue.textContent = cornerRadius;
                applyEnhancements();
            });
            
            // Crop area dragging
            setupCropAreaDragging();
        }
        
        // Set up FAQ accordion functionality
        function setupFAQAccordion() {
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    // Close all other FAQ items
                    faqItems.forEach(otherItem => {
                        if (otherItem !== item) {
                            otherItem.classList.remove('active');
                        }
                    });
                    
                    // Toggle current item
                    item.classList.toggle('active');
                });
            });
        }
        
        // Set up drag and drop functionality
        function setupDragAndDrop() {
            previewContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
                previewContainer.classList.add('drag-over');
            });
            
            previewContainer.addEventListener('dragleave', () => {
                previewContainer.classList.remove('drag-over');
            });
            
            previewContainer.addEventListener('drop', (e) => {
                e.preventDefault();
                previewContainer.classList.remove('drag-over');
                
                if (e.dataTransfer.files.length) {
                    fileUpload.files = e.dataTransfer.files;
                    handleFileUpload({ target: fileUpload });
                }
            });
        }
        
        // Set up crop area dragging functionality
        function setupCropAreaDragging() {
            const handles = document.querySelectorAll('.crop-handle');
            
            // Handle drag start
            cropArea.addEventListener('mousedown', startDrag);
            cropArea.addEventListener('touchstart', startDrag, { passive: false });
            
            handles.forEach(handle => {
                handle.addEventListener('mousedown', startResize);
                handle.addEventListener('touchstart', startResize, { passive: false });
            });
            
            // Handle drag/resize
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: false });
            
            // Handle drag end
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
        }
        
        function startDrag(e) {
            e.preventDefault();
            isDragging = true;
            dragHandle = null;
            
            const rect = cropArea.getBoundingClientRect();
            startX = (e.clientX || e.touches[0].clientX) - rect.left;
            startY = (e.clientY || e.touches[0].clientY) - rect.top;
            
            cropArea.style.cursor = 'grabbing';
        }
        
        function startResize(e) {
            e.preventDefault();
            e.stopPropagation();
            isDragging = true;
            dragHandle = e.target;
            
            const rect = cropArea.getBoundingClientRect();
            startX = (e.clientX || e.touches[0].clientX) - rect.left;
            startY = (e.clientY || e.touches[0].clientY) - rect.top;
        }
        
        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            
            const clientX = e.clientX || (e.touches && e.touches[0].clientX);
            const clientY = e.clientY || (e.touches && e.touches[0].clientY);
            
            if (!clientX || !clientY) return;
            
            const rect = cropOverlay.getBoundingClientRect();
            const x = clientX - rect.left;
            const y = clientY - rect.top;
            
            if (dragHandle) {
                // Resize based on which handle is being dragged
                const handleClass = dragHandle.className.split(' ')[1];
                
                switch(handleClass) {
                    case 'handle-nw':
                        cropWidth += cropX - x;
                        cropHeight += cropY - y;
                        cropX = x;
                        cropY = y;
                        break;
                    case 'handle-ne':
                        cropWidth = x - cropX;
                        cropHeight += cropY - y;
                        cropY = y;
                        break;
                    case 'handle-sw':
                        cropWidth += cropX - x;
                        cropHeight = y - cropY;
                        cropX = x;
                        break;
                    case 'handle-se':
                        cropWidth = x - cropX;
                        cropHeight = y - cropY;
                        break;
                }
                
                // Apply aspect ratio constraints
                if (aspectRatio !== 'free') {
                    applyAspectRatio();
                }
            } else {
                // Move the crop area
                cropX = x - startX;
                cropY = y - startY;
            }
            
            // Constrain crop area to canvas bounds
            constrainCropArea();
            updateCropArea();
            updateCropInfo();
        }
        
        function endDrag() {
            isDragging = false;
            dragHandle = null;
            cropArea.style.cursor = 'grab';
        }
        
        function constrainCropArea() {
            const minSize = 20;
            
            // Ensure minimum size
            cropWidth = Math.max(minSize, cropWidth);
            cropHeight = Math.max(minSize, cropHeight);
            
            // Constrain to canvas bounds
            const canvasRect = cropOverlay.getBoundingClientRect();
            cropX = Math.max(0, Math.min(canvasRect.width - cropWidth, cropX));
            cropY = Math.max(0, Math.min(canvasRect.height - cropHeight, cropY));
        }
        
        function updateCropArea() {
            cropArea.style.left = cropX + 'px';
            cropArea.style.top = cropY + 'px';
            cropArea.style.width = cropWidth + 'px';
            cropArea.style.height = cropHeight + 'px';
        }
        
        function updateCropInfo() {
            cropDimensions.textContent = `${Math.round(cropWidth)} × ${Math.round(cropHeight)} px`;
            cropPosition.textContent = `${Math.round(cropX)}, ${Math.round(cropY)}`;
            
            if (aspectRatio === 'free') {
                cropAspectRatio.textContent = 'Free';
            } else {
                cropAspectRatio.textContent = aspectRatio;
            }
        }
        
        // File upload functionality
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file || !file.type.match('image.*')) {
                showToast('Please select a valid image file', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    originalImage = img;
                    currentImage = img;
                    
                    // Set canvas size to match image
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    // Set crop area to initial size (centered, 80% of image)
                    const overlayRect = cropOverlay.getBoundingClientRect();
                    cropWidth = overlayRect.width * 0.8;
                    cropHeight = overlayRect.height * 0.8;
                    cropX = (overlayRect.width - cropWidth) / 2;
                    cropY = (overlayRect.height - cropHeight) / 2;
                    
                    // Update UI
                    previewPlaceholder.style.display = 'none';
                    canvasContainer.style.display = 'block';
                    updateCropArea();
                    drawImage();
                    enableActionButtons();
                    
                    // Update image info
                    originalDimensions.textContent = `${img.width} × ${img.height} px`;
                    originalSize.textContent = formatFileSize(file.size);
                    originalFormat.textContent = file.type.split('/')[1].toUpperCase();
                    
                    updateCropInfo();
                    showToast('Image loaded successfully!');
                };
                img.src = e.target.result;
            };
            
            reader.readAsDataURL(file);
        }
        
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
            else return (bytes / 1048576).toFixed(1) + ' MB';
        }
        
        // Apply aspect ratio to crop area
        function applyAspectRatio() {
            if (aspectRatio === 'free') return;
            
            let ratioWidth, ratioHeight;
            
            switch(aspectRatio) {
                case '1:1':
                    ratioWidth = 1; ratioHeight = 1;
                    break;
                case '16:9':
                    ratioWidth = 16; ratioHeight = 9;
                    break;
                case '9:16':
                    ratioWidth = 9; ratioHeight = 16;
                    break;
                case '4:3':
                    ratioWidth = 4; ratioHeight = 3;
                    break;
                case '3:2':
                    ratioWidth = 3; ratioHeight = 2;
                    break;
                default:
                    return;
            }
            
            const newHeight = cropWidth * ratioHeight / ratioWidth;
            if (newHeight <= cropOverlay.getBoundingClientRect().height) {
                cropHeight = newHeight;
            } else {
                const newWidth = cropHeight * ratioWidth / ratioHeight;
                cropWidth = newWidth;
            }
            
            constrainCropArea();
            updateCropArea();
            updateCropInfo();
        }
        
        function applyCustomRatio() {
            const width = parseInt(customWidth.value) || 1;
            const height = parseInt(customHeight.value) || 1;
            
            if (width > 0 && height > 0) {
                const newHeight = cropWidth * height / width;
                if (newHeight <= cropOverlay.getBoundingClientRect().height) {
                    cropHeight = newHeight;
                } else {
                    const newWidth = cropHeight * width / height;
                    cropWidth = newWidth;
                }
                
                constrainCropArea();
                updateCropArea();
                updateCropInfo();
            }
        }
        
        // Fit crop area to entire image
        function fitToArea() {
            if (!currentImage) return;
            
            const overlayRect = cropOverlay.getBoundingClientRect();
            cropX = 0;
            cropY = 0;
            cropWidth = overlayRect.width;
            cropHeight = overlayRect.height;
            
            updateCropArea();
            updateCropInfo();
            showToast('Crop area fitted to image');
        }
        
        // Image manipulation functions
        function rotateImage(degrees) {
            if (!currentImage) return;
            
            // Create a temporary canvas to rotate the image
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            
            // Swap dimensions if rotating 90 or 270 degrees
            if (Math.abs(degrees) === 90) {
                tempCanvas.width = currentImage.height;
                tempCanvas.height = currentImage.width;
            } else {
                tempCanvas.width = currentImage.width;
                tempCanvas.height = currentImage.height;
            }
            
            // Translate to center and rotate
            tempCtx.translate(tempCanvas.width / 2, tempCanvas.height / 2);
            tempCtx.rotate(degrees * Math.PI / 180);
            tempCtx.drawImage(currentImage, -currentImage.width / 2, -currentImage.height / 2);
            
            // Create new image from rotated canvas
            const rotatedImage = new Image();
            rotatedImage.onload = function() {
                currentImage = rotatedImage;
                canvas.width = rotatedImage.width;
                canvas.height = rotatedImage.height;
                drawImage();
                showToast(`Image rotated ${degrees > 0 ? 'right' : 'left'}`);
            };
            rotatedImage.src = tempCanvas.toDataURL();
        }
        
        function flipHorizontal() {
            if (!currentImage) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.scale(-1, 1);
            ctx.drawImage(currentImage, -canvas.width, 0);
            ctx.setTransform(1, 0, 0, 1, 0, 0);
            
            showToast('Image flipped horizontally');
        }
        
        function flipVertical() {
            if (!currentImage) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.scale(1, -1);
            ctx.drawImage(currentImage, 0, -canvas.height);
            ctx.setTransform(1, 0, 0, 1, 0, 0);
            
            showToast('Image flipped vertically');
        }
        
        function resetImage() {
            if (!originalImage) return;
            
            currentImage = originalImage;
            canvas.width = originalImage.width;
            canvas.height = originalImage.height;
            
            // Reset enhancements
            brightness = 0;
            contrast = 0;
            saturation = 0;
            blur = 0;
            cornerRadius = 0;
            
            brightnessSlider.value = 0;
            contrastSlider.value = 0;
            saturationSlider.value = 0;
            blurSlider.value = 0;
            cornerRadiusSlider.value = 0;
            
            brightnessValue.textContent = '0';
            contrastValue.textContent = '0';
            saturationValue.textContent = '0';
            blurValue.textContent = '0';
            cornerRadiusValue.textContent = '0';
            
            drawImage();
            showToast('Image reset to original');
        }
        
        function autoEnhance() {
            // Simple auto-enhancement by adjusting levels
            brightness = 10;
            contrast = 15;
            saturation = 10;
            
            brightnessSlider.value = brightness;
            contrastSlider.value = contrast;
            saturationSlider.value = saturation;
            
            brightnessValue.textContent = brightness;
            contrastValue.textContent = contrast;
            saturationValue.textContent = saturation;
            
            applyEnhancements();
            showToast('Auto-enhancement applied');
        }
        
        function toggleBlurBackground() {
            // This would be a more complex implementation in a real app
            showToast('Background blur toggled');
        }
        
        function toggleRoundedCorners() {
            cornerRadius = cornerRadius > 0 ? 0 : 20;
            cornerRadiusSlider.value = cornerRadius;
            cornerRadiusValue.textContent = cornerRadius;
            applyEnhancements();
            showToast(`Rounded corners ${cornerRadius > 0 ? 'enabled' : 'disabled'}`);
        }
        
        function applyCircleCrop() {
            // This would create a circular crop mask
            showToast('Circle crop applied');
        }
        
        function toggleBorder() {
            // This would add a border to the image
            showToast('Border toggled');
        }
        
        function toggleShadow() {
            // This would add a shadow effect
            showToast('Shadow toggled');
        }
        
        function toggleGrid() {
            isGridVisible = !isGridVisible;
            gridOverlay.style.display = isGridVisible ? 'block' : 'none';
            
            if (isGridVisible) {
                // Create rule of thirds grid
                gridOverlay.innerHTML = '';
                
                // Vertical lines
                for (let i = 1; i < 3; i++) {
                    const line = document.createElement('div');
                    line.className = 'grid-line grid-vertical';
                    line.style.left = `${(i / 3) * 100}%`;
                    gridOverlay.appendChild(line);
                }
                
                // Horizontal lines
                for (let i = 1; i < 3; i++) {
                    const line = document.createElement('div');
                    line.className = 'grid-line grid-horizontal';
                    line.style.top = `${(i / 3) * 100}%`;
                    gridOverlay.appendChild(line);
                }
            }
            
            showToast(`Grid ${isGridVisible ? 'shown' : 'hidden'}`);
        }
        
        function zoomImage(amount) {
            zoomLevel = Math.max(0.1, Math.min(5, zoomLevel + amount));
            drawImage();
            showToast(`Zoom: ${Math.round(zoomLevel * 100)}%`);
        }
        
        function applyEnhancements() {
            if (!currentImage) return;
            
            drawImage();
            
            // Apply filters if any enhancement is active
            if (brightness !== 0 || contrast !== 0 || saturation !== 0 || blur !== 0) {
                ctx.filter = `brightness(${100 + brightness}%) contrast(${100 + contrast}%) saturate(${100 + saturation}%) blur(${blur}px)`;
                ctx.drawImage(currentImage, 0, 0, canvas.width, canvas.height);
                ctx.filter = 'none';
            }
        }
        
        function drawImage() {
            if (!currentImage) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Calculate scaled dimensions based on zoom
            const scaledWidth = currentImage.width * zoomLevel;
            const scaledHeight = currentImage.height * zoomLevel;
            
            // Center the image
            const x = (canvas.width - scaledWidth) / 2 + imageOffsetX;
            const y = (canvas.height - scaledHeight) / 2 + imageOffsetY;
            
            ctx.drawImage(currentImage, x, y, scaledWidth, scaledHeight);
        }
        
        function applyCrop() {
            if (!currentImage) return;
            
            // Get the crop area in image coordinates
            const overlayRect = cropOverlay.getBoundingClientRect();
            const scaleX = currentImage.width / overlayRect.width;
            const scaleY = currentImage.height / overlayRect.height;
            
            const cropXImage = cropX * scaleX;
            const cropYImage = cropY * scaleY;
            const cropWidthImage = cropWidth * scaleX;
            const cropHeightImage = cropHeight * scaleY;
            
            // Create a new canvas for the cropped image
            const croppedCanvas = document.createElement('canvas');
            croppedCanvas.width = cropWidthImage;
            croppedCanvas.height = cropHeightImage;
            const croppedCtx = croppedCanvas.getContext('2d');
            
            // Draw the cropped portion
            croppedCtx.drawImage(
                currentImage,
                cropXImage, cropYImage, cropWidthImage, cropHeightImage,
                0, 0, cropWidthImage, cropHeightImage
            );
            
            // Update the main canvas with the cropped image
            currentImage = new Image();
            currentImage.onload = function() {
                canvas.width = this.width;
                canvas.height = this.height;
                drawImage();
                showToast('Crop applied successfully');
            };
            currentImage.src = croppedCanvas.toDataURL();
        }
        
        function downloadImage() {
            if (!currentImage) return;
            
            const link = document.createElement('a');
            link.download = 'cropped-image.png';
            link.href = canvas.toDataURL('image/png');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Image downloaded successfully!');
        }
        
        function batchCrop() {
            showToast('Batch cropping would process multiple images with the same settings');
        }
        
        function savePreset() {
            showToast('Crop settings saved as preset');
        }
        
        function applySocialPreset(preset) {
            const overlayRect = cropOverlay.getBoundingClientRect();
            let width, height;
            
            switch(preset) {
                case 'instagram-post':
                    width = overlayRect.width;
                    height = overlayRect.width; // 1:1 ratio
                    break;
                case 'instagram-story':
                    width = overlayRect.width * 0.75; // 9:16 ratio
                    height = overlayRect.height;
                    break;
                case 'facebook-cover':
                    width = overlayRect.width;
                    height = overlayRect.height * 0.38; // 820x312 ratio
                    break;
                case 'twitter-post':
                    width = overlayRect.width;
                    height = overlayRect.width * 0.5625; // 16:9 ratio
                    break;
                case 'youtube-thumbnail':
                    width = overlayRect.width;
                    height = overlayRect.width * 0.5625; // 16:9 ratio
                    break;
                case 'linkedin-banner':
                    width = overlayRect.width;
                    height = overlayRect.height * 0.25; // 1584x396 ratio
                    break;
                default:
                    return;
            }
            
            // Center the crop area
            cropWidth = width;
            cropHeight = height;
            cropX = (overlayRect.width - width) / 2;
            cropY = (overlayRect.height - height) / 2;
            
            updateCropArea();
            updateCropInfo();
            showToast(`${preset.replace('-', ' ')} preset applied`);
        }
        
        function enableActionButtons() {
            cropBtn.disabled = false;
            downloadBtn.disabled = false;
            batchCropBtn.disabled = false;
        }
        
        // Toast notification
        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = type === 'error' ? 'toast error' : 'toast';
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }
        
        // Initialize the application
        init();
    </script>
</body>
</html>
